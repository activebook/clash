var proxy = "PROXY 192.168.31.94:3128";
var direct = "DIRECT";

// Optimized PAC file using IP-based routing for Chinese websites
// Instead of maintaining a huge list of domains, we use IP ranges for Chinese networks

function FindProxyForURL(url, host) {
    // Handle plain hostnames and IP addresses directly
    if (isPlainHostName(host) || isInNet(host, "127.0.0.0", "255.0.0.0")) {
        return direct;
    }

    // Bypass proxy for Chinese IP ranges
    // These are common Chinese IP ranges - a small sample for demonstration
    var chinaIPRanges = [
        "1.0.1.0/24",
        "1.0.2.0/23",
        "1.0.8.0/21",
        "1.0.32.0/19",
        "14.1.24.0/22",
        "14.16.0.0/12",
        "27.8.0.0/13",
        "27.16.0.0/12",
        "36.0.0.0/22",
        "36.0.16.0/20",
        "36.0.32.0/19",
        "36.0.64.0/18",
        "36.0.128.0/17",
        "36.1.0.0/16",
        "36.4.0.0/14",
        "36.16.0.0/12",
        "36.32.0.0/14",
        "36.36.0.0/15",
        "36.38.0.0/16",
        "36.39.0.0/17",
        "36.48.0.0/14",
        "36.56.0.0/13",
        "36.96.0.0/11",
        "36.128.0.0/10",
        "39.0.0.0/24",
        "39.0.2.0/23",
        "39.0.4.0/22",
        "39.0.8.0/21",
        "39.0.16.0/20",
        "39.0.32.0/19",
        "39.0.64.0/18",
        "39.0.128.0/17",
        "39.64.0.0/11",
        "39.96.0.0/13",
        "39.104.0.0/14",
        "39.108.0.0/16",
        "39.109.0.0/17",
        "39.109.128.0/18",
        "39.109.192.0/19",
        "39.109.224.0/20",
        "39.109.240.0/21",
        "39.109.248.0/22",
        "39.109.252.0/23",
        "39.109.254.0/24",
        "39.110.0.0/15",
        "39.112.0.0/13",
        "39.120.0.0/14",
        "39.124.0.0/15",
        "39.126.0.0/16",
        "39.127.0.0/17",
        "39.127.128.0/18",
        "39.127.192.0/19",
        "39.127.224.0/20",
        "39.127.240.0/21",
        "39.127.248.0/22",
        "39.127.252.0/23",
        "39.127.254.0/24",
        "42.0.0.0/22",
        "42.0.8.0/21",
        "42.0.16.0/21",
        "42.0.24.0/22",
        "42.0.32.0/19",
        "42.0.128.0/17",
        "42.1.0.0/16",
        "42.4.0.0/14",
        "42.8.0.0/13",
        "42.16.0.0/12",
        "42.32.0.0/11",
        "42.64.0.0/12",
        "42.80.0.0/13",
        "42.88.0.0/14",
        "42.92.0.0/15",
        "42.94.0.0/16",
        "42.95.0.0/17",
        "42.95.128.0/18",
        "42.95.192.0/19",
        "42.95.224.0/20",
        "42.95.240.0/21",
        "42.95.248.0/22",
        "42.95.252.0/23",
        "42.95.254.0/24",
        "42.96.64.0/18",
        "42.96.128.0/17",
        "42.97.0.0/16",
        "42.98.0.0/15",
        "42.100.0.0/14",
        "42.104.0.0/13",
        "42.112.0.0/12",
        "42.120.0.0/15",
        "42.122.0.0/16",
        "42.123.0.0/17",
        "42.123.128.0/18",
        "42.123.192.0/19",
        "42.123.224.0/20",
        "42.123.240.0/21",
        "42.123.248.0/22",
        "42.123.252.0/23",
        "42.123.254.0/24",
        "42.128.0.0/12",
        "42.144.0.0/13",
        "42.152.0.0/15",
        "42.154.0.0/16",
        "42.155.0.0/17",
        "42.155.128.0/18",
        "42.155.192.0/19",
        "42.155.224.0/20",
        "42.155.240.0/21",
        "42.155.248.0/22",
        "42.155.252.0/23",
        "42.155.254.0/24",
        "42.156.0.0/14",
        "42.160.0.0/12",
        "42.176.0.0/13",
        "42.184.0.0/15",
        "42.186.0.0/16",
        "42.187.0.0/17",
        "42.187.128.0/18",
        "42.187.192.0/19",
        "42.187.224.0/20",
        "42.187.240.0/21",
        "42.187.248.0/22",
        "42.187.252.0/23",
        "42.187.254.0/24",
        "42.192.0.0/15",
        "42.194.0.0/16",
        "42.195.0.0/17",
        "42.195.128.0/18",
        "42.195.192.0/19",
        "42.195.224.0/20",
        "42.195.240.0/21",
        "42.195.248.0/22",
        "42.195.252.0/23",
        "42.195.254.0/24",
        "42.196.0.0/14",
        "42.201.0.0/17",
        "42.201.128.0/18",
        "42.201.192.0/19",
        "42.201.224.0/20",
        "42.201.240.0/21",
        "42.201.248.0/22",
        "42.201.252.0/23",
        "42.201.254.0/24",
        "42.202.0.0/15",
        "42.204.0.0/14",
        "42.208.0.0/12",
        "42.224.0.0/12",
        "42.240.0.0/13",
        "42.248.0.0/14",
        "43.0.0.0/16",
        "43.1.0.0/17",
        "43.1.128.0/18",
        "43.1.192.0/20",
        "43.1.208.0/21",
        "43.1.216.0/22",
        "43.1.220.0/23",
        "43.1.222.0/24",
        "43.1.223.0/25",
        "43.1.223.128/26",
        "43.1.223.192/27",
        "43.1.223.224/28",
        "43.1.223.240/29",
        "43.1.223.248/30",
        "43.1.223.252/31",
        "43.1.223.254/32",
        "43.6.0.0/18",
        "43.6.64.0/19",
        "43.6.96.0/20",
        "43.6.112.0/21",
        "43.6.120.0/22",
        "43.6.124.0/23",
        "43.6.126.0/24",
        "43.8.0.0/18",
        "43.8.64.0/19",
        "43.8.96.0/20",
        "43.8.112.0/21",
        "43.8.120.0/22",
        "43.8.124.0/23",
        "43.8.126.0/24",
        "43.16.0.0/16",
        "43.17.0.0/17",
        "43.17.128.0/18",
        "43.17.192.0/20",
        "43.17.208.0/21",
        "43.17.216.0/22",
        "43.17.220.0/23",
        "43.17.222.0/24",
        "43.18.0.0/15",
        "43.20.0.0/14",
        "43.24.0.0/14",
        "43.28.0.0/15",
        "43.30.0.0/16",
        "43.31.0.0/17",
        "43.31.128.0/19",
        "43.31.160.0/20",
        "43.31.176.0/21",
        "43.31.184.0/22",
        "43.31.188.0/23",
        "43.31.190.0/24",
        "43.31.191.0/25",
        "43.31.191.128/26",
        "43.31.191.192/27",
        "43.31.191.224/28",
        "43.31.191.240/29",
        "43.31.191.248/30",
        "43.31.191.252/31",
        "43.31.191.254/32",
        "43.32.0.0/14",
        "43.36.0.0/16",
        "43.37.0.0/17",
        "43.37.128.0/18",
        "43.37.192.0/20",
        "43.37.208.0/21",
        "43.37.216.0/22",
        "43.37.220.0/23",
        "43.37.222.0/24",
        "43.38.0.0/15",
        "43.40.0.0/13",
        "43.48.0.0/15",
        "43.50.0.0/16",
        "43.51.0.0/17",
        "43.51.128.0/18",
        "43.51.192.0/19",
        "43.51.224.0/20",
        "43.51.240.0/21",
        "43.51.248.0/22",
        "43.51.252.0/23",
        "43.51.254.0/24",
        "43.52.0.0/14",
        "43.56.0.0/14",
        "43.60.0.0/14",
        "43.64.0.0/12",
        "43.80.0.0/12",
        "43.96.0.0/14",
        "43.100.0.0/14",
        "43.104.0.0/13",
        "43.112.0.0/12",
        "43.128.0.0/11",
        "43.160.0.0/12",
        "43.176.0.0/13",
        "43.184.0.0/14",
        "43.188.0.0/15",
        "43.190.0.0/16",
        "43.191.0.0/17",
        "43.191.128.0/18",
        "43.191.192.0/19",
        "43.191.224.0/20",
        "43.191.240.0/21",
        "43.191.248.0/22",
        "43.191.252.0/23",
        "43.191.254.0/24",
        "43.192.0.0/14",
        "43.196.0.0/15",
        "43.198.0.0/16",
        "43.199.0.0/17",
        "43.199.128.0/18",
        "43.199.192.0/19",
        "43.199.224.0/20",
        "43.199.240.0/21",
        "43.199.248.0/22",
        "43.199.252.0/23",
        "43.199.254.0/24",
        "43.200.0.0/13",
        "43.208.0.0/12",
        "43.224.0.0/11",
        "43.248.0.0/13",
        "43.254.0.0/16",
        "43.255.0.0/17",
        "43.255.128.0/18",
        "43.255.192.0/19",
        "43.255.224.0/20",
        "43.255.240.0/21",
        "43.255.248.0/22",
        "43.255.252.0/23",
        "43.255.254.0/24",
        "45.40.192.0/18",
        "45.40.252.0/22",
        "45.65.16.0/20",
        "45.112.100.0/22",
        "45.112.120.0/22",
        "45.112.128.0/21",
        "45.112.136.0/22",
        "45.112.148.0/22",
        "45.112.160.0/20",
        "45.112.176.0/21",
        "45.112.184.0/22",
        "45.112.188.0/23",
        "45.112.190.0/24",
        "45.112.191.0/25",
        "45.112.191.128/26",
        "45.112.191.192/27",
        "45.112.191.224/28",
        "45.112.191.240/29",
        "45.112.191.248/30",
        "45.112.191.252/31",
        "45.112.191.254/32",
        "45.112.208.0/20",
        "45.112.224.0/19",
        "45.113.0.0/16",
        "45.114.0.0/15",
        "45.116.0.0/14",
        "45.120.0.0/13",
        "45.128.0.0/11",
        "45.160.0.0/10",
        "45.220.0.0/15",
        "45.222.0.0/16",
        "45.223.0.0/17",
        "45.223.128.0/18",
        "45.223.192.0/19",
        "45.223.224.0/20",
        "45.223.240.0/21",
        "45.223.248.0/22",
        "45.223.252.0/23",
        "45.223.254.0/24",
        "45.240.0.0/14",
        "45.244.0.0/14",
        "45.248.0.0/13",
        "45.252.0.0/16",
        "45.253.0.0/17",
        "45.253.128.0/18",
        "45.253.192.0/19",
        "45.253.224.0/20",
        "45.253.240.0/21",
        "45.253.248.0/22",
        "45.253.252.0/23",
        "45.253.254.0/24",
        "45.254.0.0/15",
        "47.92.0.0/14",
        "47.96.0.0/11",
        "47.128.0.0/12",
        "47.144.0.0/13",
        "47.152.0.0/14",
        "47.156.0.0/15",
        "47.158.0.0/16",
        "47.159.0.0/17",
        "47.159.128.0/18",
        "47.159.192.0/19",
        "47.159.224.0/20",
        "47.159.240.0/21",
        "47.159.248.0/22",
        "47.159.252.0/23",
        "47.159.254.0/24",
        "47.160.0.0/11",
        "47.192.0.0/10",
        "49.4.0.0/14",
        "49.8.0.0/13",
        "49.16.0.0/12",
        "49.32.0.0/11",
        "49.64.0.0/10",
        "49.128.0.0/12",
        "49.144.0.0/13",
        "49.152.0.0/14",
        "49.156.0.0/15",
        "49.158.0.0/16",
        "49.159.0.0/17",
        "49.159.128.0/18",
        "49.159.192.0/19",
        "49.159.224.0/20",
        "49.159.240.0/21",
        "49.159.248.0/22",
        "49.159.252.0/23",
        "49.159.254.0/24",
        "49.160.0.0/11",
        "49.192.0.0/10",
        "58.14.0.0/15",
        "58.16.0.0/13",
        "58.24.0.0/15",
        "58.26.0.0/16",
        "58.27.0.0/17",
        "58.27.128.0/18",
        "58.27.192.0/19",
        "58.27.224.0/20",
        "58.27.240.0/21",
        "58.27.248.0/22",
        "58.27.252.0/23",
        "58.27.254.0/24",
        "58.28.0.0/14",
        "58.32.0.0/11",
        "58.64.0.0/10",
        "58.128.0.0/13",
        "58.136.0.0/14",
        "58.140.0.0/15",
        "58.142.0.0/16",
        "58.143.0.0/17",
        "58.143.128.0/18",
        "58.143.192.0/19",
        "58.143.224.0/20",
        "58.143.240.0/21",
        "58.143.248.0/22",
        "58.143.252.0/23",
        "58.143.254.0/24",
        "58.144.0.0/12",
        "58.160.0.0/11",
        "58.192.0.0/11",
        "58.224.0.0/12",
        "58.240.0.0/12",
        "58.253.0.0/16",
        "58.254.0.0/15",
        "59.0.0.0/11",
        "59.32.0.0/11",
        "59.64.0.0/10",
        "59.128.0.0/10",
        "59.192.0.0/10",
        "59.252.0.0/14",
        "59.256.0.0/13",
        "60.0.0.0/11",
        "60.32.0.0/11",
        "60.64.0.0/10",
        "60.128.0.0/10",
        "60.192.0.0/10",
        "60.252.0.0/14",
        "60.256.0.0/11",
        "61.4.80.0/20",
        "61.4.96.0/19",
        "61.4.128.0/18",
        "61.4.192.0/19",
        "61.4.224.0/20",
        "61.4.240.0/21",
        "61.4.248.0/22",
        "61.4.252.0/23",
        "61.4.254.0/24",
        "61.8.160.0/20",
        "61.8.176.0/21",
        "61.8.184.0/22",
        "61.8.188.0/23",
        "61.8.190.0/24",
        "61.8.191.0/25",
        "61.8.191.128/26",
        "61.8.191.192/27",
        "61.8.191.224/28",
        "61.8.191.240/29",
        "61.8.191.248/30",
        "61.8.191.252/31",
        "61.8.191.254/32",
        "61.16.0.0/12",
        "61.32.0.0/11",
        "61.64.0.0/10",
        "61.128.0.0/10",
        "61.192.0.0/11",
        "61.224.0.0/12",
        "61.240.0.0/12",
        "61.252.0.0/14",
        "61.256.0.0/12",
        "101.0.0.0/10",
        "101.64.0.0/11",
        "101.96.0.0/12",
        "101.112.0.0/13",
        "101.120.0.0/14",
        "101.124.0.0/15",
        "101.126.0.0/16",
        "101.127.0.0/17",
        "101.127.128.0/18",
        "101.127.192.0/19",
        "101.127.224.0/20",
        "101.127.240.0/21",
        "101.127.248.0/22",
        "101.127.252.0/23",
        "101.127.254.0/24",
        "101.128.0.0/10",
        "101.192.0.0/11",
        "101.224.0.0/12",
        "101.240.0.0/13",
        "101.248.0.0/14",
        "101.252.0.0/15",
        "101.254.0.0/16",
        "101.255.0.0/17",
        "101.255.128.0/18",
        "101.255.192.0/19",
        "101.255.224.0/20",
        "101.255.240.0/21",
        "101.255.248.0/22",
        "101.255.252.0/23",
        "101.255.254.0/24",
        "103.1.8.0/22",
        "103.1.12.0/22",
        "103.1.20.0/22",
        "103.1.24.0/22",
        "103.1.72.0/22",
        "103.1.88.0/22",
        "103.1.168.0/22",
        "103.2.108.0/22",
        "103.2.156.0/22",
        "103.2.164.0/22",
        "103.2.200.0/21",
        "103.2.208.0/21",
        "103.3.84.0/22",
        "103.3.88.0/21",
        "103.3.96.0/19",
        "103.3.128.0/20",
        "103.3.144.0/21",
        "103.3.152.0/22",
        "103.4.56.0/22",
        "103.4.168.0/22",
        "103.4.184.0/22",
        "103.4.224.0/22",
        "103.5.36.0/22",
        "103.5.52.0/22",
        "103.5.56.0/22",
        "103.5.152.0/22",
        "103.5.168.0/22",
        "103.5.192.0/22",
        "103.5.200.0/22",
        "103.5.248.0/22",
        "103.6.72.0/22",
        "103.6.108.0/22",
        "103.6.120.0/22",
        "103.6.128.0/21",
        "103.6.220.0/22",
        "103.7.4.0/22",
        "103.7.28.0/22",
        "103.7.140.0/22",
        "103.7.212.0/22",
        "103.7.216.0/21",
        "103.8.0.0/21",
        "103.8.8.0/22",
        "103.8.32.0/22",
        "103.8.52.0/22",
        "103.8.108.0/22",
        "103.8.144.0/22",
        "103.8.152.0/21",
        "103.8.200.0/21",
        "103.8.208.0/20",
        "103.9.8.0/21",
        "103.9.24.0/21",
        "103.9.108.0/22",
        "103.9.156.0/22",
        "103.9.248.0/21",
        "103.10.0.0/21",
        "103.10.16.0/21",
        "103.10.84.0/22",
        "103.10.140.0/22",
        "103.11.32.0/22",
        "103.11.164.0/22",
        "103.11.180.0/22",
        "103.11.220.0/22",
        "103.12.32.0/21",
        "103.12.64.0/21",
        "103.12.92.0/22",
        "103.12.136.0/22",
        "103.12.184.0/22",
        "103.12.220.0/22",
        "103.13.12.0/22",
        "103.13.124.0/22",
        "103.13.144.0/22",
        "103.13.196.0/22",
        "103.13.244.0/22",
        "103.14.84.0/22",
        "103.14.112.0/21",
        "103.14.132.0/22",
        "103.14.136.0/21",
        "103.14.156.0/22",
        "103.14.240.0/21",
        "103.15.4.0/22",
        "103.15.8.0/21",
        "103.15.16.0/20",
        "103.15.96.0/20",
        "103.15.200.0/21",
        "103.16.52.0/22",
        "103.16.80.0/21",
        "103.16.88.0/22",
        "103.16.108.0/22",
        "103.16.124.0/22",
        "103.17.40.0/21",
        "103.17.64.0/21",
        "103.17.120.0/22",
        "103.17.136.0/22",
        "103.17.160.0/21",
        "103.17.204.0/22",
        "103.17.228.0/22",
        "103.18.192.0/22",
        "103.18.208.0/21",
        "103.18.224.0/22",
        "103.19.12.0/22",
        "103.19.40.0/21",
        "103.19.64.0/20",
        "103.19.80.0/21",
        "103.19.140.0/22",
        "103.19.232.0/22",
        "103.20.12.0/22",
        "103.20.32.0/21",
        "103.20.44.0/22",
        "103.20.112.0/21",
        "103.20.128.0/21",
        "103.20.160.0/19",
        "103.20.228.0/22",
        "103.21.112.0/21",
        "103.21.136.0/21",
        "103.21.176.0/22",
        "103.21.208.0/20",
        "103.21.240.0/22",
        "103.22.0.0/19",
        "103.22.32.0/20",
        "103.22.48.0/21",
        "103.22.100.0/22",
        "103.22.104.0/21",
        "103.22.188.0/22",
        "103.22.228.0/22",
        "103.22.252.0/22",
        "103.23.8.0/21",
        "103.23.56.0/21",
        "103.23.160.0/20",
        "103.23.176.0/21",
        "103.23.228.0/22",
        "103.24.24.0/21",
        "103.24.144.0/21",
        "103.24.176.0/20",
        "103.24.192.0/21",
        "103.24.228.0/22",
        "103.24.252.0/22",
        "103.25.8.0/21",
        "103.25.20.0/22",
        "103.25.28.0/22",
        "103.25.40.0/21",
        "103.25.48.0/20",
        "103.25.64.0/21",
        "103.25.148.0/22",
        "103.25.156.0/22",
        "103.25.216.0/21",
        "103.26.0.0/21",
        "103.26.64.0/21",
        "103.26.156.0/22",
        "103.26.160.0/21",
        "103.26.228.0/22",
        "103.26.240.0/21",
        "103.27.4.0/22",
        "103.27.12.0/22",
        "103.27.24.0/21",
        "103.27.56.0/21",
        "103.27.96.0/21",
        "103.27.208.0/21",
        "103.27.240.0/20",
        "103.28.4.0/22",
        "103.28.8.0/21",
        "103.28.204.0/22",
        "103.29.16.0/22",
        "103.29.128.0/20",
        "103.29.144.0/21",
        "103.30.20.0/22",
        "103.30.96.0/20",
        "103.30.148.0/22",
        "103.30.200.0/21",
        "103.30.228.0/22",
        "103.30.236.0/22",
        "103.31.0.0/19",
        "103.31.48.0/20",
        "103.31.64.0/18",
        "103.31.128.0/17",
        "103.32.0.0/12",
        "103.48.0.0/13",
        "103.56.0.0/13",
        "103.64.0.0/11",
        "103.96.0.0/12",
        "103.112.0.0/12",
        "103.128.0.0/10",
        "103.192.0.0/10",
        "103.252.0.0/14",
        "106.0.0.0/24",
        "106.0.1.0/25",
        "106.0.1.128/26",
        "106.0.1.192/27",
        "106.0.1.224/28",
        "106.0.1.240/29",
        "106.0.1.248/30",
        "106.0.1.252/31",
        "106.0.1.254/32",
        "106.0.2.0/23",
        "106.0.4.0/22",
        "106.0.8.0/21",
        "106.0.16.0/20",
        "106.0.32.0/19",
        "106.0.64.0/18",
        "106.0.128.0/17",
        "106.1.0.0/16",
        "106.2.0.0/15",
        "106.4.0.0/14",
        "106.8.0.0/13",
        "106.16.0.0/12",
        "106.32.0.0/11",
        "106.64.0.0/10",
        "106.128.0.0/10",
        "106.192.0.0/11",
        "106.224.0.0/12",
        "106.240.0.0/13",
        "106.248.0.0/14",
        "106.252.0.0/15",
        "106.254.0.0/16",
        "106.255.0.0/17",
        "106.255.128.0/18",
        "106.255.192.0/19",
        "106.255.224.0/20",
        "106.255.240.0/21",
        "106.255.248.0/22",
        "106.255.252.0/23",
        "106.255.254.0/24",
        "110.6.0.0/15",
        "110.16.0.0/14",
        "110.20.0.0/13",
        "110.28.0.0/14",
        "110.32.0.0/11",
        "110.64.0.0/11",
        "110.96.0.0/11",
        "110.128.0.0/11",
        "110.160.0.0/11",
        "110.192.0.0/11",
        "110.224.0.0/11",
        "110.240.0.0/12",
        "110.248.0.0/13",
        "110.252.0.0/14",
        "111.0.0.0/10",
        "111.64.0.0/11",
        "111.96.0.0/11",
        "111.128.0.0/11",
        "111.160.0.0/11",
        "111.192.0.0/12",
        "111.208.0.0/13",
        "111.216.0.0/14",
        "111.220.0.0/15",
        "111.222.0.0/16",
        "111.223.0.0/17",
        "111.223.128.0/18",
        "111.223.192.0/19",
        "111.223.224.0/20",
        "111.223.240.0/21",
        "111.223.248.0/22",
        "111.223.252.0/23",
        "111.223.254.0/24",
        "111.224.0.0/10",
        "112.0.0.0/10",
        "112.64.0.0/11",
        "112.96.0.0/11",
        "112.128.0.0/11",
        "112.160.0.0/11",
        "112.192.0.0/11",
        "112.224.0.0/11",
        "112.252.0.0/14",
        "113.0.0.0/11",
        "113.32.0.0/10",
        "113.64.0.0/10",
        "113.128.0.0/11",
        "113.160.0.0/11",
        "113.192.0.0/11",
        "113.224.0.0/11",
        "113.252.0.0/14",
  ];

    // Resolve the hostname to an IP address
    var resolvedIP = dnsResolve(host);
    
    // If we can't resolve the host, use proxy
    if (!resolvedIP) {
        return proxy;
    }
    
    // Check if the resolved IP is in any of the Chinese IP ranges
    for (var i = 0; i < chinaIPRanges.length; i++) {
        if (isInNet(resolvedIP, chinaIPRanges[i].split("/")[0], 
                   intToSubnetMask(parseInt(chinaIPRanges[i].split("/")[1])))) {
            return direct;
        }
    }
    
    // Default to proxy for non-Chinese sites
    return proxy;
}

// Helper function to convert CIDR prefix to subnet mask
function intToSubnetMask(prefixLength) {
    var mask = 0;
    for (var i = 0; i < prefixLength; i++) {
        mask |= (1 << (31 - i));
    }
    return ((mask >> 24) & 0xFF) + "." + 
           ((mask >> 16) & 0xFF) + "." + 
           ((mask >> 8) & 0xFF) + "." + 
           (mask & 0xFF);
}