
var proxy = "PROXY 192.168.31.94:3128";
var direct = "DIRECT";

var directSuffixes = {
    "13th.tech": 1,
    "423down.com": 1,
    "bokecc.com": 1,
    "chaipip.com": 1,
    "chinaplay.store": 1,
    "hrtsea.com": 1,
    "kaikeba.com": 1,
    "laomo.me": 1,
    "mpyit.com": 1,
    "msftconnecttest.com": 1,
    "msftncsi.com": 1,
    "qupu123.com": 1,
    "pdfwifi.com": 1,
    "zhenguanyu.biz": 1,
    "zhenguanyu.com": 1,
    "snapdrop.net": 1,
    "tebex.io": 1,
    "cn": 1,
    "xn--fiqs8s": 1,
    "xn--55qx5d": 1,
    "xn--io0a7i": 1,
    "360.com": 1,
    "360kuai.com": 1,
    "360safe.com": 1,
    "dhrest.com": 1,
    "qhres.com": 1,
    "qhstatic.com": 1,
    "qhupdate.com": 1,
    "so.com": 1,
    "4399.com": 1,
    "4399pk.com": 1,
    "5054399.com": 1,
    "img4399.com": 1,
    "58.com": 1,
    "1688.com": 1,
    "aliapp.org": 1,
    "alibaba.com": 1,
    "alibabacloud.com": 1,
    "alibabausercontent.com": 1,
    "alicdn.com": 1,
    "alicloudccp.com": 1,
    "aliexpress.com": 1,
    "aliimg.com": 1,
    "alikunlun.com": 1,
    "alipay.com": 1,
    "alipayobjects.com": 1,
    "alisoft.com": 1,
    "aliyun.com": 1,
    "aliyuncdn.com": 1,
    "aliyuncs.com": 1,
    "aliyundrive.com": 1,
    "aliyundrive.net": 1,
    "amap.com": 1,
    "autonavi.com": 1,
    "dingtalk.com": 1,
    "ele.me": 1,
    "hichina.com": 1,
    "mmstat.com": 1,
    "mxhichina.com": 1,
    "soku.com": 1,
    "taobao.com": 1,
    "taobaocdn.com": 1,
    "tbcache.com": 1,
    "tbcdn.com": 1,
    "tmall.com": 1,
    "tmall.hk": 1,
    "ucweb.com": 1,
    "xiami.com": 1,
    "xiami.net": 1,
    "ykimg.com": 1,
    "youku.com": 1,
    "qwen.ai": 1,
    "baidu.com": 1,
    "baidubcr.com": 1,
    "baidupcs.com": 1,
    "baidustatic.com": 1,
    "bcebos.com": 1,
    "bdimg.com": 1,
    "bdstatic.com": 1,
    "bdurl.net": 1,
    "hao123.com": 1,
    "hao123img.com": 1,
    "jomodns.com": 1,
    "yunjiasu-cdn.net": 1,
    "acg.tv": 1,
    "acgvideo.com": 1,
    "b23.tv": 1,
    "bigfun.cn": 1,
    "bigfunapp.cn": 1,
    "biliapi.com": 1,
    "biliapi.net": 1,
    "bilibili.com": 1,
    "bilibili.co": 1,
    "biliintl.co": 1,
    "biligame.com": 1,
    "biligame.net": 1,
    "bilivideo.com": 1,
    "bilivideo.cn": 1,
    "hdslb.com": 1,
    "im9.com": 1,
    "smtcdns.net": 1,
    "amemv.com": 1,
    "bdxiguaimg.com": 1,
    "bdxiguastatic.com": 1,
    "byted-static.com": 1,
    "bytedance.com": 1,
    "bytedance.net": 1,
    "bytedns.net": 1,
    "bytednsdoc.com": 1,
    "bytegoofy.com": 1,
    "byteimg.com": 1,
    "bytescm.com": 1,
    "bytetos.com": 1,
    "bytexservice.com": 1,
    "douyin.com": 1,
    "douyincdn.com": 1,
    "douyinpic.com": 1,
    "douyinstatic.com": 1,
    "douyinvod.com": 1,
    "feelgood.cn": 1,
    "feiliao.com": 1,
    "gifshow.com": 1,
    "huoshan.com": 1,
    "huoshanzhibo.com": 1,
    "ibytedapm.com": 1,
    "iesdouyin.com": 1,
    "ixigua.com": 1,
    "kspkg.com": 1,
    "pstatp.com": 1,
    "snssdk.com": 1,
    "toutiao.com": 1,
    "toutiao13.com": 1,
    "toutiaoapi.com": 1,
    "toutiaocdn.com": 1,
    "toutiaocdn.net": 1,
    "toutiaocloud.com": 1,
    "toutiaohao.com": 1,
    "toutiaohao.net": 1,
    "toutiaoimg.com": 1,
    "toutiaopage.com": 1,
    "wukong.com": 1,
    "zijieapi.com": 1,
    "zijieimg.com": 1,
    "zjbyte.com": 1,
    "zjcdn.com": 1,
    "cctv.com": 1,
    "cctvpic.com": 1,
    "livechina.com": 1,
    "auth.wo.cn": 1,
    "cmpassport.com": 1,
    "id6.me": 1,
    "mob.com": 1,
    "open.e.189.cn": 1,
    "21cn.com": 1,
    "didialift.com": 1,
    "didiglobal.com": 1,
    "udache.com": 1,
    "bytefcdnrd.com": 1,
    "edgesrv.com": 1,
    "douyu.com": 1,
    "douyu.tv": 1,
    "douyucdn.cn": 1,
    "douyuscdn.com": 1,
    "douyutv.com": 1,
    "epicgames.com": 1,
    "epicgames.dev": 1,
    "helpshift.com": 1,
    "paragon.com": 1,
    "unrealengine.com": 1,
    "dbankcdn.com": 1,
    "hc-cdn.com": 1,
    "hicloud.com": 1,
    "hihonor.com": 1,
    "huawei.com": 1,
    "huaweicloud.com": 1,
    "huaweishop.net": 1,
    "hwccpc.com": 1,
    "vmall.com": 1,
    "vmallres.com": 1,
    "allawnfs.com": 1,
    "allawno.com": 1,
    "allawntech.com": 1,
    "coloros.com": 1,
    "heytap.com": 1,
    "heytapcs.com": 1,
    "heytapdownload.com": 1,
    "heytapimage.com": 1,
    "heytapmobi.com": 1,
    "oppo.com": 1,
    "oppoer.me": 1,
    "oppomobile.com": 1,
    "iflyink.com": 1,
    "iflyrec.com": 1,
    "iflytek.com": 1,
    "71.am": 1,
    "71edge.com": 1,
    "iqiyi.com": 1,
    "iqiyipic.com": 1,
    "ppsimg.com": 1,
    "qiyi.com": 1,
    "qiyipic.com": 1,
    "qy.net": 1,
    "360buy.com": 1,
    "360buyimg.com": 1,
    "jcloudcs.com": 1,
    "jd.com": 1,
    "jd.hk": 1,
    "jdcloud.com": 1,
    "jdpay.com": 1,
    "paipai.com": 1,
    "iciba.com": 1,
    "ksosoft.com": 1,
    "ksyun.com": 1,
    "kuaishou.com": 1,
    "yximgs.com": 1,
    "meitu.com": 1,
    "meitudata.com": 1,
    "meitustat.com": 1,
    "meipai.com": 1,
    "le.com": 1,
    "lecloud.com": 1,
    "letv.com": 1,
    "letvcloud.com": 1,
    "letvimg.com": 1,
    "letvlive.com": 1,
    "letvstore.com": 1,
    "hitv.com": 1,
    "hunantv.com": 1,
    "mgtv.com": 1,
    "duokan.com": 1,
    "mi-img.com": 1,
    "mi.com": 1,
    "miui.com": 1,
    "xiaomi.com": 1,
    "xiaomi.net": 1,
    "xiaomicp.com": 1,
    "126.com": 1,
    "126.net": 1,
    "127.net": 1,
    "163.com": 1,
    "163yun.com": 1,
    "lofter.com": 1,
    "netease.com": 1,
    "ydstatic.com": 1,
    "youdao.com": 1,
    "pplive.com": 1,
    "pptv.com": 1,
    "pinduoduo.com": 1,
    "yangkeduo.com": 1,
    "leju.com": 1,
    "miaopai.com": 1,
    "sina.com": 1,
    "sina.com.cn": 1,
    "sina.cn": 1,
    "sinaapp.com": 1,
    "sinaapp.cn": 1,
    "sinaimg.com": 1,
    "sinaimg.cn": 1,
    "weibo.com": 1,
    "weibo.cn": 1,
    "weibocdn.com": 1,
    "weibocdn.cn": 1,
    "xiaoka.tv": 1,
    "go2map.com": 1,
    "sogo.com": 1,
    "sogou.com": 1,
    "sogoucdn.com": 1,
    "sohu-inc.com": 1,
    "sohu.com": 1,
    "sohucs.com": 1,
    "sohuno.com": 1,
    "sohurdc.com": 1,
    "v-56.com": 1,
    "playstation.com": 1,
    "playstation.net": 1,
    "playstationnetwork.com": 1,
    "sony.com": 1,
    "sonyentertainmentnetwork.com": 1,
    "cm.steampowered.com": 1,
    "steamcontent.com": 1,
    "steamusercontent.com": 1,
    "steamchina.com": 1,
    "foxmail.com": 1,
    "gtimg.com": 1,
    "idqqimg.com": 1,
    "igamecj.com": 1,
    "myapp.com": 1,
    "myqcloud.com": 1,
    "qq.com": 1,
    "qqmail.com": 1,
    "qqurl.com": 1,
    "smtcdns.com": 1,
    "smtcdns.net": 1,
    "soso.com": 1,
    "tencent-cloud.net": 1,
    "tencent.com": 1,
    "tencentmind.com": 1,
    "tenpay.com": 1,
    "wechat.com": 1,
    "weixin.com": 1,
    "weiyun.com": 1,
    "appsimg.com": 1,
    "appvipshop.com": 1,
    "vip.com": 1,
    "vipstatic.com": 1,
    "ximalaya.com": 1,
    "xmcdn.com": 1,
    "00cdn.com": 1,
    "88cdn.com": 1,
    "kanimg.com": 1,
    "kankan.com": 1,
    "p2cdn.com": 1,
    "sandai.net": 1,
    "thundercdn.com": 1,
    "xunlei.com": 1,
    "got001.com": 1,
    "p4pfile.com": 1,
    "rrys.tv": 1,
    "rrys2020.com": 1,
    "yyets.com": 1,
    "zimuzu.io": 1,
    "zimuzu.tv": 1,
    "zmz001.com": 1,
    "zmz002.com": 1,
    "zmz003.com": 1,
    "zmz004.com": 1,
    "zmz2019.com": 1,
    "zmzapi.com": 1,
    "zmzapi.net": 1,
    "zmzfile.com": 1,
    "teamviewer.com": 1,
    "baomitu.com": 1,
    "bootcss.com": 1,
    "jiasule.com": 1,
    "staticfile.org": 1,
    "upaiyun.com": 1,
    "doh.pub": 1,
    "dns.alidns.com": 1,
    "doh.360.cn": 1,
    "10010.com": 1,
    "115.com": 1,
    "12306.com": 1,
    "17173.com": 1,
    "178.com": 1,
    "17k.com": 1,
    "360doc.com": 1,
    "36kr.com": 1,
    "3dmgame.com": 1,
    "51cto.com": 1,
    "51job.com": 1,
    "51jobcdn.com": 1,
    "56.com": 1,
    "8686c.com": 1,
    "abchina.com": 1,
    "abercrombie.com": 1,
    "acfun.tv": 1,
    "air-matters.com": 1,
    "air-matters.io": 1,
    "aixifan.com": 1,
    "algocasts.io": 1,
    "babytree.com": 1,
    "babytreeimg.com": 1,
    "baicizhan.com": 1,
    "baidupan.com": 1,
    "baike.com": 1,
    "biqudu.com": 1,
    "biquge.com": 1,
    "bitauto.com": 1,
    "bosszhipin.com": 1,
    "c-ctrip.com": 1,
    "camera360.com": 1,
    "cdnmama.com": 1,
    "chaoxing.com": 1,
    "che168.com": 1,
    "chinacache.net": 1,
    "chinaso.com": 1,
    "chinaz.com": 1,
    "chinaz.net": 1,
    "chuimg.com": 1,
    "cibntv.net": 1,
    "clouddn.com": 1,
    "cloudxns.net": 1,
    "cn163.net": 1,
    "cnblogs.com": 1,
    "cnki.net": 1,
    "cnmstl.net": 1,
    "coolapk.com": 1,
    "coolapkmarket.com": 1,
    "csdn.net": 1,
    "ctrip.com": 1,
    "dangdang.com": 1,
    "dfcfw.com": 1,
    "dianping.com": 1,
    "dilidili.wang": 1,
    "douban.com": 1,
    "doubanio.com": 1,
    "dpfile.com": 1,
    "duowan.com": 1,
    "dxycdn.com": 1,
    "dytt8.net": 1,
    "easou.com": 1,
    "eastday.com": 1,
    "eastmoney.com": 1,
    "ecitic.com": 1,
    "element-plus.org": 1,
    "ewqcxz.com": 1,
    "fang.com": 1,
    "fantasy.tv": 1,
    "feng.com": 1,
    "fengkongcloud.com": 1,
    "fir.im": 1,
    "frdic.com": 1,
    "fresh-ideas.cc": 1,
    "ganji.com": 1,
    "ganjistatic1.com": 1,
    "geetest.com": 1,
    "geilicdn.com": 1,
    "ghpym.com": 1,
    "godic.net": 1,
    "guazi.com": 1,
    "gwdang.com": 1,
    "gzlzfm.com": 1,
    "haibian.com": 1,
    "haosou.com": 1,
    "hollisterco.com": 1,
    "hongxiu.com": 1,
    "huajiao.com": 1,
    "hupu.com": 1,
    "huxiucdn.com": 1,
    "huya.com": 1,
    "ifeng.com": 1,
    "ifengimg.com": 1,
    "images-amazon.com": 1,
    "infzm.com": 1,
    "ipip.net": 1,
    "it168.com": 1,
    "ithome.com": 1,
    "ixdzs.com": 1,
    "jianguoyun.com": 1,
    "jianshu.com": 1,
    "jianshu.io": 1,
    "jianshuapi.com": 1,
    "jiathis.com": 1,
    "jmstatic.com": 1,
    "jumei.com": 1,
    "kaola.com": 1,
    "knewone.com": 1,
    "koowo.com": 1,
    "koyso.com": 1,
    "ksyungslb.com": 1,
    "kuaidi100.com": 1,
    "kugou.com": 1,
    "lancdns.com": 1,
    "landiannews.com": 1,
    "lanzou.com": 1,
    "lanzoui.com": 1,
    "lanzoux.com": 1,
    "lemicp.com": 1,
    "letitfly.me": 1,
    "lizhi.fm": 1,
    "lizhi.io": 1,
    "lizhifm.com": 1,
    "luoo.net": 1,
    "lvmama.com": 1,
    "lxdns.com": 1,
    "maoyan.com": 1,
    "meilishuo.com": 1,
    "meituan.com": 1,
    "meituan.net": 1,
    "meizu.com": 1,
    "migucloud.com": 1,
    "miguvideo.com": 1,
    "mobike.com": 1,
    "mogu.com": 1,
    "mogucdn.com": 1,
    "mogujie.com": 1,
    "moji.com": 1,
    "moke.com": 1,
    "msstatic.com": 1,
    "mubu.com": 1,
    "myunlu.com": 1,
    "nruan.com": 1,
    "nuomi.com": 1,
    "onedns.net": 1,
    "oneplus.com": 1,
    "onlinedown.net": 1,
    "oracle.com": 1,
    "oschina.net": 1,
    "ourdvs.com": 1,
    "polyv.net": 1,
    "qbox.me": 1,
    "qcloud.com": 1,
    "qcloudcdn.com": 1,
    "qdaily.com": 1,
    "qdmm.com": 1,
    "qhimg.com": 1,
    "qianqian.com": 1,
    "qidian.com": 1,
    "qihucdn.com": 1,
    "qin.io": 1,
    "qiniu.com": 1,
    "qiniucdn.com": 1,
    "qiniudn.com": 1,
    "qiushibaike.com": 1,
    "quanmin.tv": 1,
    "qunar.com": 1,
    "qunarzz.com": 1,
    "realme.com": 1,
    "repaik.com": 1,
    "ruguoapp.com": 1,
    "runoob.com": 1,
    "sankuai.com": 1,
    "segmentfault.com": 1,
    "sf-express.com": 1,
    "shumilou.net": 1,
    "simplecd.me": 1,
    "smzdm.com": 1,
    "snwx.com": 1,
    "soufunimg.com": 1,
    "sspai.com": 1,
    "startssl.com": 1,
    "suning.com": 1,
    "synology.com": 1,
    "taihe.com": 1,
    "th-sjy.com": 1,
    "tianqi.com": 1,
    "tianqistatic.com": 1,
    "tianyancha.com": 1,
    "tianyaui.com": 1,
    "tietuku.com": 1,
    "tiexue.net": 1,
    "tmiaoo.com": 1,
    "trip.com": 1,
    "ttmeiju.com": 1,
    "tudou.com": 1,
    "tuniu.com": 1,
    "tuniucdn.com": 1,
    "umengcloud.com": 1,
    "upyun.com": 1,
    "uxengine.net": 1,
    "videocc.net": 1,
    "vivo.com": 1,
    "wandoujia.com": 1,
    "weather.com": 1,
    "weico.cc": 1,
    "weidian.com": 1,
    "weiphone.com": 1,
    "weiphone.net": 1,
    "womai.com": 1,
    "wscdns.com": 1,
    "xdrig.com": 1,
    "xhscdn.com": 1,
    "xiachufang.com": 1,
    "xiaohongshu.com": 1,
    "xiaojukeji.com": 1,
    "xinhuanet.com": 1,
    "xip.io": 1,
    "xitek.com": 1,
    "xiumi.us": 1,
    "xslb.net": 1,
    "xueqiu.com": 1,
    "yach.me": 1,
    "yeepay.com": 1,
    "yhd.com": 1,
    "yihaodianimg.com": 1,
    "yinxiang.com": 1,
    "yinyuetai.com": 1,
    "yixia.com": 1,
    "ys168.com": 1,
    "yuewen.com": 1,
    "yy.com": 1,
    "yystatic.com": 1,
    "zealer.com": 1,
    "zhangzishi.cc": 1,
    "zhanqi.tv": 1,
    "zhaopin.com": 1,
    "zhihu.com": 1,
    "zhimg.com": 1,
    "zhipin.com": 1,
    "zhongsou.com": 1,
    "zhuihd.com": 1,
    "cmbchina.com": 1,
    "95516.com": 1
};

var directKeywords = [
    "360buy",
    "alicdn",
    "alimama",
    "alipay",
    "appzapp",
    "baidupcs",
    "bilibili",
    "ccgslb",
    "chinacache",
    "duobao",
    "jdpay",
    "moke",
    "qhimg",
    "vpimg",
    "xiami",
    "xiaomi"
];

var directCIDRs = [
    "8.128.0.0/10",
    "8.209.32.0/22",
    "8.209.40.0/21",
    "8.209.48.0/20",
    "8.210.0.0/16",
    "8.211.64.0/18",
    "8.211.128.0/20",
    "8.211.144.0/21",
    "8.211.152.0/22",
    "8.211.208.0/20",
    "8.211.224.0/19",
    "8.212.0.0/14",
    "8.216.0.0/13",
    "14.1.112.0/22",
    "45.112.212.0/22",
    "47.52.0.0/16",
    "47.56.0.0/15",
    "47.75.0.0/16",
    "47.89.0.0/18",
    "47.89.64.0/24",
    "47.89.82.0/23",
    "47.89.91.0/24",
    "47.89.100.0/23",
    "47.90.0.0/17",
    "47.91.128.0/17",
    "47.92.0.0/14",
    "47.240.0.0/16",
    "47.242.0.0/15",
    "47.244.0.0/16",
    "47.246.5.0/24",
    "47.246.16.0/24",
    "47.246.60.0/23",
    "47.246.65.0/24",
    "59.82.0.0/20",
    "59.82.240.0/21",
    "59.82.248.0/22",
    "103.52.76.0/22",
    "103.206.40.0/22",
    "110.76.21.0/24",
    "110.76.23.0/24",
    "112.125.0.0/17",
    "116.251.79.0/24",
    "116.251.80.0/22",
    "116.251.84.0/24",
    "116.251.88.0/22",
    "116.251.93.0/24",
    "116.251.94.0/23",
    "116.251.102.0/23",
    "116.251.104.0/21",
    "116.251.112.0/21",
    "116.251.124.0/22",
    "119.38.208.0/20",
    "119.38.224.0/20",
    "119.42.224.0/20",
    "140.205.1.0/24",
    "140.205.122.0/24",
    "149.129.64.0/18",
    "163.181.32.0/22",
    "163.181.40.0/24",
    "170.33.0.0/22",
    "198.11.141.0/24",
    "198.11.184.0/21",
    "205.204.104.0/23",
    "205.204.117.0/24",
    "205.204.122.0/23",
    "205.204.124.0/22",
    "45.40.192.0/19",
    "49.51.56.0/22",
    "49.51.60.0/23",
    "49.51.110.0/23",
    "49.51.112.0/20",
    "62.234.0.0/16",
    "94.191.0.0/17",
    "103.7.28.0/22",
    "109.244.0.0/16",
    "111.30.128.0/21",
    "111.30.136.0/24",
    "111.30.139.0/24",
    "111.30.140.0/23",
    "115.159.0.0/16",
    "119.28.0.0/18",
    "119.28.64.0/19",
    "119.28.124.0/23",
    "119.28.128.0/20",
    "119.28.164.0/22",
    "119.28.168.0/21",
    "119.28.176.0/20",
    "119.28.192.0/19",
    "119.28.224.0/21",
    "119.29.0.0/16",
    "121.51.0.0/16",
    "129.28.0.0/16",
    "129.204.0.0/16",
    "129.211.0.0/16",
    "132.232.0.0/16",
    "134.175.0.0/16",
    "146.56.192.0/18",
    "150.109.32.0/19",
    "150.109.64.0/20",
    "150.109.96.0/19",
    "152.136.0.0/16",
    "162.14.0.0/16",
    "182.254.0.0/16",
    "188.131.128.0/17",
    "203.195.128.0/17",
    "203.205.128.0/20",
    "203.205.144.0/21",
    "203.205.158.0/24",
    "203.205.180.0/22",
    "203.205.208.0/22",
    "203.205.212.0/23",
    "203.205.218.0/23",
    "203.205.220.0/22",
    "203.205.248.0/21",
    "212.64.0.0/17",
    "212.129.128.0/17",
    "45.113.194.0/23",
    "63.243.252.0/24",
    "103.235.44.0/22",
    "106.12.0.0/15",
    "114.28.224.0/20",
    "180.76.0.0/16",
    "182.61.0.0/16",
    "185.10.105.0/24",
    "202.46.48.0/20",
    "203.90.238.0/24",
    "43.254.0.0/22",
    "45.249.212.0/22",
    "49.4.0.0/17",
    "103.31.200.0/22",
    "103.218.216.0/22",
    "114.115.128.0/17",
    "114.116.0.0/16",
    "116.63.128.0/18",
    "116.66.184.0/22",
    "117.78.0.0/18",
    "119.3.0.0/16",
    "119.8.32.0/19",
    "121.36.0.0/17",
    "121.36.128.0/18",
    "121.37.0.0/17",
    "122.112.128.0/17",
    "139.9.0.0/18",
    "139.9.64.0/19",
    "139.9.100.0/22",
    "139.9.104.0/21",
    "139.9.112.0/20",
    "139.9.128.0/18",
    "139.9.192.0/19",
    "139.9.224.0/20",
    "139.9.240.0/21",
    "139.9.248.0/22",
    "139.159.128.0/19",
    "139.159.160.0/22",
    "139.159.164.0/23",
    "139.159.168.0/21",
    "139.159.176.0/20",
    "139.159.192.0/18",
    "159.138.0.0/18",
    "159.138.64.0/21",
    "159.138.79.0/24",
    "159.138.80.0/20",
    "159.138.96.0/20",
    "159.138.112.0/21",
    "159.138.125.0/24",
    "159.138.128.0/19",
    "42.186.0.0/16",
    "45.127.128.0/22",
    "45.195.24.0/24",
    "45.253.132.0/22",
    "45.253.240.0/22",
    "45.254.48.0/23",
    "59.111.0.0/20",
    "59.111.128.0/17",
    "103.71.120.0/21",
    "103.71.128.0/22",
    "103.71.196.0/22",
    "103.71.200.0/22",
    "103.72.12.0/22",
    "103.72.18.0/23",
    "103.72.24.0/22",
    "103.72.28.0/23",
    "103.72.38.0/23",
    "103.72.40.0/23",
    "103.72.44.0/22",
    "103.72.48.0/21",
    "103.72.128.0/21",
    "103.74.24.0/21",
    "103.74.48.0/22",
    "103.129.252.0/22",
    "103.131.252.0/22",
    "103.135.240.0/22",
    "103.196.64.0/22",
    "106.2.32.0/19",
    "106.2.64.0/18",
    "114.113.196.0/22",
    "114.113.200.0/22",
    "115.236.112.0/20",
    "115.238.76.0/22",
    "123.58.160.0/19",
    "223.252.192.0/19",
    "101.198.128.0/18",
    "101.198.192.0/24",
    "101.198.194.0/23",
    "101.198.196.0/22",
    "101.198.200.0/21",
    "101.198.208.0/20",
    "101.199.196.0/22"
];

function FindProxyForURL(url, host) {
    // 1. Check if host is plain hostname (no dots)
    if (isPlainHostName(host)) {
        return direct;
    }

    // 2. Check Domain Suffixes (Optimized with object lookup)
    // We check from longest match to shortest. 
    // Actually, for a hash map, we can check parts.
    // But simple suffix matching in loop is easier for PAC or using shExpMatch.
    // Optimization: Check the last part of the host against the map?
    // A common PAC optimization is to use an object as a hash set.
    
    var lastDot = host.lastIndexOf('.');
    if (lastDot !== -1) {
        // Check exact match or suffix
        // Iterate over domain parts to find match in directSuffixes
        var parts = host.split('.');
        for (var i = 0; i < parts.length; i++) {
            var domain = parts.slice(i).join('.');
            if (directSuffixes.hasOwnProperty(domain)) {
                return direct;
            }
        }
    }

    // 3. Check Keywords
    for (var i = 0; i < directKeywords.length; i++) {
        if (host.indexOf(directKeywords[i]) !== -1) {
            return direct;
        }
    }

    // 4. Check IPs
    // If host is an IP address, check against CIDRs
    // We use a regex to check if it looks like an IP
    var ipRegex = /^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;
    if (ipRegex.test(host)) {
        for (var i = 0; i < directCIDRs.length; i++) {
            var cidr = directCIDRs[i];
            var split = cidr.split('/');
            var ip = split[0];
            var mask = split[1];
            // isInNet is standard PAC function
            // Note: mask in isInNet usually expects 255.255.255.0 format or similar, 
            // but some implementations support CIDR or we need to convert.
            // Standard PAC isInNet(host, pattern, mask) uses IP strings.
            // We need to convert CIDR prefix length to subnet mask string.
            if (isInNet(host, ip, convertMask(mask))) {
                return direct;
            }
        }
    }

    return proxy;
}

// Helper to convert CIDR prefix to mask string (e.g. 24 -> 255.255.255.0)
function convertMask(bitCount) {
    var mask = [];
    for(var i=0; i<4; i++) {
        var n = Math.min(bitCount, 8);
        mask.push(256 - Math.pow(2, 8-n));
        bitCount -= n;
    }
    return mask.join('.');
}
